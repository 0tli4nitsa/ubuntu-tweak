<?xml version="1.0" encoding="UTF-8"?> <!-- -*- XML -*- -->

<!DOCTYPE busconfig PUBLIC
 "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">
<busconfig>
    <!-- Only root can own the service -->
    <policy user="root">
        <allow own="com.ubuntu_tweak.daemon"/>
        <allow own="com.ubuntu_tweak.daemon.packageconfig"/>
        <allow send_destination="com.ubuntu_tweak.daemon" />
        <allow send_destination="com.ubuntu_tweak.daemon.packageconfig" />
        <allow send_destination="com.ubuntu_tweak.daemon" send_interface="org.freedesktop.DBus.Introspectable" />
        <allow send_destination="com.ubuntu_tweak.daemon" send_interface="org.freedesktop.DBus.Properties" />
        <allow send_destination="com.ubuntu_tweak.daemon.packageconfig" send_interface="org.freedesktop.DBus.Introspectable" />
        <allow send_destination="com.ubuntu_tweak.daemon.packageconfig" send_interface="org.freedesktop.DBus.Properties" />
    </policy>
    
    <!-- Allow anyone to invoke methods on the interfaces -->
    <policy context="default">
        <deny own="com.ubuntu_tweak.daemon"/>

        <deny send_destination="com.ubuntu_tweak.daemon"/>
        <deny send_destination="com.ubuntu_tweak.daemon.packageconfig"/>
    </policy>

    <policy group="admin">
        <!-- be able to speak to the dispatcher -->
        <allow send_destination="com.ubuntu_tweak.daemon"/>
    </policy>
</busconfig>
